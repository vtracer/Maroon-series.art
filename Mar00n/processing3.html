<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="stylesheet" href="css/maya.css?v=1">
  <link rel="stylesheet" href="css/lyrics.css?v=1">
  <link rel="stylesheet" href="css/elias_reiss.css?v=1">
  <link rel="stylesheet" href="css/maroon-glitch.css?v=1">
  <script defer src="js/maroon-glitch.js"></script>
  <title>MAR00N // Chapter 01: #PROCESSING</title>
  <style>
    :root {
      --nlt-gold: #ffb000;
      --nlt-violet: #8b00ff;
      --nlt-bg: #050505;
      --nlt-text: #d1d1d1;
      --nlt-dim: #444;
    }

    body, html {
      background-color: var(--nlt-bg);
      color: var(--nlt-text);
      font-family: 'Courier New', Courier, monospace;
      margin: 0;
      padding: 0;
      overflow-x: hidden;
    }

    body::before {
      content: " ";
      display: block;
      position: fixed;
      top: 0; left: 0; bottom: 0; right: 0;
      background:
        linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%),
        linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
      z-index: 2;
      background-size: 100% 4px, 3px 100%;
      pointer-events: none;
    }

    header {
      border-bottom: 1px solid var(--nlt-dim);
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #000;
    }

    nav a {
      color: var(--nlt-gold);
      text-decoration: none;
      margin-left: 20px;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 2px;
    }

    #viewport {
      padding: 40px 20px;
      max-width: 800px;
      margin: auto;
      position: relative;
    }

    /* Background image for the pod interior (50% opacity) */
    #viewport::before{
      content: '';
      position: absolute;
      inset: 0;
      background-image: url('pod_background.png');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      opacity: 0.10;
      pointer-events: none;
      z-index: 0;
      filter: brightness(0.85) contrast(0.98);
    }

    /* ensure viewport children render above the background image */
    #viewport > * { position: relative; z-index: 1; }

    /* Terminal-style status box (slick corporate + cyberpunk) */
    .status-bar {
      padding: 16px 18px;
      margin-bottom: 40px;
      border-radius: 8px;
      position: relative;
      background:
        linear-gradient(180deg, rgba(10,10,10,0.28), rgba(0,0,0,0.36)),
        linear-gradient(90deg, rgba(255,186,90,0.02), rgba(255,176,0,0.06));
      border: 1px solid rgba(255,176,0,0.72);
      box-shadow:
        0 6px 18px rgba(0,0,0,0.6),        /* outer depth */
        inset 0 1px 0 rgba(255,255,255,0.02), /* subtle inner rim */
        0 0 28px rgba(255,176,0,0.06);      /* faint ambient glow */
      backdrop-filter: blur(4px) saturate(110%);
      overflow: visible;
    }

    /* sheen stripe for corporate polish */
    .status-bar::after{
      content: '';
      position: absolute;
      left: -2%; top: 0;
      width: 104%; height: 28%;
      background: linear-gradient(90deg, rgba(255,255,255,0.06), rgba(255,255,255,0.0));
      transform: skewY(-6deg);
      pointer-events: none;
      mix-blend-mode: overlay;
      border-radius: 6px 6px 0 0;
      opacity: 0.9;
    }

    /* Shared counter style for PROCESS NODE and RUNTIME (orange terminal text) */
    .terminal-counter,
    .counter {
      color: var(--nlt-gold);
      font-weight: 800;
      font-size: 1.16rem;
      font-family: 'Courier New', Courier, monospace;
      letter-spacing: 1px;
      text-shadow: 0 0 12px rgba(255,176,0,0.28), 0 0 32px rgba(255,176,0,0.06);
      -webkit-font-smoothing: antialiased;
      display: inline-block;
    }

    /* small accent line on the left to suggest UI panel */
    .status-bar::before{
      content: '';
      position: absolute;
      left: 0; top: 6px;
      width: 6px; height: calc(100% - 12px);
      background: linear-gradient(180deg, rgba(255,200,100,0.95), rgba(255,160,0,0.9));
      border-radius: 3px 0 0 3px;
      box-shadow: 0 0 18px rgba(255,176,0,0.12);
      pointer-events: none;
    }

    h1 {
      color: var(--nlt-violet);
      letter-spacing: 3px;
      border: none;
      padding: 0;
      font-size: 1.3rem;
      font-weight: normal;
      text-shadow: 0 0 10px rgba(139,0,255,0.4), 0 0 20px rgba(139,0,255,0.15);
      margin-bottom: 30px;
      width: 100%;
      text-align: center;
      text-transform: uppercase;
    }

    /* Violet variant of the blink-word animation used in processing2.html */
    .blink-word { display: inline-block; animation: signBlinkViolet 2s cubic-bezier(0.5, 0, 0.5, 1) infinite; }

    @keyframes signBlinkViolet {
      0% { opacity: 1; text-shadow: 0 0 8px rgba(139,0,255,0.6); }
      45% { opacity: 1; text-shadow: 0 0 8px rgba(139,0,255,0.6); }
      48% { opacity: 0.2; text-shadow: 0 0 2px rgba(139,0,255,0.15); }
      50% { opacity: 0.85; text-shadow: 0 0 6px rgba(139,0,255,0.4); }
      52% { opacity: 0.15; text-shadow: 0 0 1px rgba(139,0,255,0.1); }
      54% { opacity: 0.9; text-shadow: 0 0 7px rgba(139,0,255,0.5); }
      56% { opacity: 0.25; text-shadow: 0 0 2px rgba(139,0,255,0.2); }
      58% { opacity: 1; text-shadow: 0 0 8px rgba(139,0,255,0.6); }
      100% { opacity: 1; text-shadow: 0 0 8px rgba(139,0,255,0.6); }
    }

    /* Ensure the inner glitch span also uses the violet blink for stronger effect */
    h1.blink-word .glitch { display: inline-block; animation: signBlinkViolet 2s cubic-bezier(0.5, 0, 0.5, 1) infinite; }

    .manuscript-text {
      line-height: 1.8;
      font-size: 1.1rem;
      white-space: normal;
    }

	.manuscript-text .span-mark.block{
  display: block;
  margin: 0 0 10px 0;
}
/* Subtle links (no underline, small color shift) */
a{
  color: rgba(255,176,0,.78);     /* soft amber */
  text-decoration: none;
}

a:hover,
a:focus-visible{
  color: rgba(255,176,0,.92);
  text-decoration: none;
}

/* If you want them even less obvious inside body copy */
.manuscript-text a{
  color: rgba(234,238,247,.78);   /* barely different from text */
  border-bottom: 1px solid rgba(255,176,0,.18); /* optional “hint” underline */
}

.manuscript-text a:hover,
.manuscript-text a:focus-visible{
  color: rgba(234,238,247,.92);
  border-bottom-color: rgba(255,176,0,.32);
}
    .highlight {
      background-color: var(--nlt-violet);
      color: white;
      padding: 0 5px;
    }

    /* Typewriter effect for text */
    @keyframes typewriter {
      from { width: 0; }
      to { width: 100%; }
    }

    @keyframes blinkCursor {
      50% { border-color: transparent; }
    }

    .typewriter {
      display: inline-block;
      overflow: hidden;
      white-space: nowrap;
      border-right: 2px solid var(--nlt-text);
      animation: typewriter 4s steps(40, end), blinkCursor 0.75s step-end infinite;
    }

    /* Glitch effect for emotional text */
    .glitch {
      position: relative;
      color: var(--nlt-violet);
      animation: glitch 1.5s infinite;
    }

    @keyframes glitch {
      0% { text-shadow: 2px 2px 0 #ff0000, -2px -2px 0 #0000ff; }
      50% { text-shadow: -2px -2px 0 #ff0000, 2px 2px 0 #0000ff; }
      100% { text-shadow: 2px 2px 0 #ff0000, -2px -2px 0 #0000ff; }
    }

    /* Heavy glitch burst — normally inert, activates when .glitch-burst is toggled */
    .heavy-glitch { position: relative; display: inline-block; }
    .heavy-glitch.glitch-burst {
      animation: heavyShake 1.6s ease-in-out infinite;
      text-shadow: 0 0 8px rgba(255,0,128,0.9), 0 0 18px rgba(0,200,255,0.6), -4px 0 6px rgba(255,180,0,0.6);
      filter: saturate(1.25) contrast(1.05);
    }

    @keyframes heavyShake {
      0% { transform: translateX(0) skewX(0deg); }
      10% { transform: translateX(-6px) skewX(-6deg); }
      20% { transform: translateX(6px) skewX(6deg); }
      30% { transform: translateX(-10px) skewX(-8deg); }
      40% { transform: translateX(8px) skewX(6deg); }
      50% { transform: translateX(-6px) skewX(-4deg); }
      60% { transform: translateX(6px) skewX(4deg); }
      70% { transform: translateX(-4px) skewX(-2deg); }
      80% { transform: translateX(4px) skewX(2deg); }
      90% { transform: translateX(-2px) skewX(-1deg); }
      100% { transform: translateX(0) skewX(0deg); }
    }

    /* Rapid chromatic slice overlays during glitch bursts */
    .heavy-glitch.glitch-burst::before,
    .heavy-glitch.glitch-burst::after{
      content: attr(data-text);
      position: absolute;
      left: 0; top: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      mix-blend-mode: screen;
      opacity: 0.85;
    }
    .heavy-glitch.glitch-burst::before{ color: rgba(255,40,140,0.85); transform: translateX(-4px); clip-path: inset(0 0 50% 0); }
    .heavy-glitch.glitch-burst::after{ color: rgba(0,200,255,0.9); transform: translateX(4px); clip-path: inset(50% 0 0 0); }

    @media (prefers-reduced-motion: reduce) {
      .heavy-glitch.glitch-burst, .heavy-glitch.glitch-burst::before, .heavy-glitch.glitch-burst::after { animation: none !important; transform: none !important; }
    }

    /* Flicker effect for short quoted lines */
    .flicker{ display:inline-block; position:relative; }
    .flicker.flickering{ animation: flickerAnim 800ms steps(4,end) both; text-shadow: 0 0 8px rgba(255,255,255,0.9), 0 0 14px rgba(255,160,0,0.12); }
    @keyframes flickerAnim{ 0%{opacity:1}10%{opacity:0.05}20%{opacity:1}30%{opacity:0.2}40%{opacity:1}60%{opacity:0.35}80%{opacity:1}100%{opacity:1} }
    @media (prefers-reduced-motion: reduce){ .flicker.flickering{ animation:none !important } }

    /* Force terminal counters in the status bar to use the gold runtime color */
    .status-bar .terminal-counter {
      color: var(--nlt-gold) !important;
      text-shadow: 0 0 10px var(--nlt-gold), 0 0 24px rgba(255,176,0,0.08) !important;
      font-weight: 700;
    }

    /* Terminal orange emphasis for in-body lines */
    .terminal-orange {
      color: var(--nlt-gold);
      font-weight: 800;
      text-shadow: 0 0 12px rgba(255,176,0,0.28), 0 0 28px rgba(255,176,0,0.06);
      background: linear-gradient(90deg, rgba(255,176,0,0.02), rgba(255,176,0,0.00));
      padding: 0 4px;
      border-radius: 3px;
    }

    /* Highlighted emotional words */
    .highlight {
      background: linear-gradient(90deg, rgba(255,0,0,0.5), rgba(255,255,0,0.5));
      padding: 0 4px;
      border-radius: 4px;
    }

    /* `.glitch` and `.blink-word` styles moved to css/maroon-glitch.css */

    /* Optional: style your converted spans so you can see them */
    .span-mark {
      /* uncomment if you want debug visibility */
      /* outline: 1px dashed rgba(255,176,0,.22); */
    }

    #processing-target {
      margin-top: 50px;
      border: 1px dashed var(--nlt-gold);
      padding: 20px;
      color: var(--nlt-gold);
      background: rgba(255, 176, 0, 0.05);
    }

    footer {
      margin-top: 100px;
      padding: 40px;
      text-align: center;
      border-top: 1px solid var(--nlt-dim);
      font-size: 0.7rem;
      color: var(--nlt-dim);
    }

    /* MAR00N footer styles (copied/implemented for processing.html) */
    .maroon-footer{
      margin-top: 60px;
      padding: 28px 20px;
      text-align: center;
      border-top: 1px solid rgba(255,255,255,0.04);
      color: var(--nlt-dim);
      background: transparent;
    }

    .maroon-footer .maroon-home{
      display:inline-flex;
      flex-direction:column;
      gap:2px;
      align-items:center;
      text-decoration:none;
      color: var(--nlt-text);
      font-weight:700;
      letter-spacing:2px;
    }

    .maroon-footer .maroon-mark{
      font-size:1rem;
      display:inline-block;
      color: #ffffff; /* ensure MAR00N appears white */
      text-shadow: 0 0 10px rgba(255,255,255,0.9), 0 0 18px rgba(255,240,200,0.08);
      -webkit-text-fill-color: #ffffff;
    }

    .maroon-footer .maroon-sub{
      display:block;
      font-size:0.75rem;
      color: var(--nlt-dim);
      font-weight:400;
      letter-spacing:1px;
      margin-top:-2px;
    }

    .maroon-footer .maroon-home:hover .maroon-mark{ text-decoration:underline; }
    
    .nlt-prop{
  margin: 18px 0 22px;
  padding: 16px 16px 14px;
  border-radius: 14px;
  border: 1px solid rgba(255,176,0,.28);
  background: linear-gradient(180deg, rgba(255,176,0,.08), rgba(0,0,0,.22));
  box-shadow: 0 18px 60px rgba(0,0,0,.55);
}

/* “Outside the screen” printed ad poster */
.outside-ad{
  margin: 22px 0 26px;
  padding: 18px 18px 16px;
  border-radius: 10px;

  /* paper stock */
  background: linear-gradient(180deg, #f4f1e8 0%, #ece6d8 100%);
  color: #141414;

  /* physical separation */
  box-shadow:
    0 22px 70px rgba(0,0,0,.75),
    0 2px 0 rgba(255,255,255,.25) inset;
  border: 1px solid rgba(0,0,0,.18);

  /* make it feel “placed” */
  transform: rotate(-1.2deg);
  position: relative;
  isolation: isolate; /* keeps blend effects contained */
}

/* paper grain + subtle halftone */
.outside-ad::before{
  content:"";
  position:absolute;
  inset:0;
  border-radius: inherit;
  pointer-events:none;

  background:
    radial-gradient(circle at 20% 15%, rgba(0,0,0,.10), transparent 42%),
    radial-gradient(circle at 80% 25%, rgba(0,0,0,.08), transparent 45%),
    radial-gradient(circle at 35% 85%, rgba(0,0,0,.06), transparent 50%),
    repeating-linear-gradient(90deg, rgba(0,0,0,.03) 0 1px, transparent 1px 3px);
  mix-blend-mode: multiply;
  opacity: .55;
}

/* tape corners (no text, just vibe) */
.outside-ad::after{
  content:"";
  position:absolute;
  inset:-10px -6px auto auto;
  width: 74px;
  height: 26px;
  background: rgba(240,232,210,.85);
  border: 1px solid rgba(0,0,0,.12);
  box-shadow: 0 10px 25px rgba(0,0,0,.25);
  transform: rotate(12deg);
  border-radius: 6px;
  pointer-events:none;
  opacity: .95;
}

/* big ad typography: NOT your mono UI font */
.outside-ad__headline{
  font-family: Impact, Haettenschweiler, "Arial Black", system-ui, sans-serif;
  text-transform: uppercase;
  letter-spacing: 1px;
  font-size: clamp(1.15rem, 2.6vw, 1.75rem);
  line-height: 1.05;
}

/* softer third line, still print */
.outside-ad__sub{
  margin-top: 10px;
  font-family: Georgia, "Times New Roman", Times, serif;
  font-size: 1.05rem;
  line-height: 1.25;
  letter-spacing: .2px;
}

/* optional: make it feel like it’s “hovering over” the UI slightly */
.outside-ad{
  filter: saturate(0.95) contrast(1.02);
}

.music-cue{
  margin: 14px 0 18px;
  padding: 10px 12px;
  border-radius: 12px;
  border: 1px solid rgba(255,176,0,.26);
  background: rgba(255,176,0,.06);
  overflow: hidden;

  box-shadow: 0 18px 60px rgba(0,0,0,.55);
}

.music-cue__track{
  display: inline-flex;
  gap: 18px;
  white-space: nowrap;

  color: rgba(255,176,0,.96);
  font-weight: 900;
  letter-spacing: 1.6px;
  text-transform: uppercase;
  text-shadow: 0 0 18px rgba(255,176,0,.18);

  /* one-time “scroll in” */
  transform: translateX(110%);
  animation: cueIn 900ms cubic-bezier(.2,.9,.2,1) forwards;
}

@keyframes cueIn{
  to { transform: translateX(0); }
}

/* Optional: make it keep crawling like a ticker after it lands */
.music-cue.loop .music-cue__track{
  animation:
    cueIn 900ms cubic-bezier(.2,.9,.2,1) forwards,
    cueScroll 14s linear 1.1s infinite;
}

@keyframes cueScroll{
  from { transform: translateX(0); }
  to   { transform: translateX(-55%); }
}

.manuscript-text > *{
  margin: 0 0 12px 0;
}

.manuscript-text .span-mark.block{
  display:block;
  margin: 0 0 12px 0;
}

/* Architect wrap with binary drip effect */
.architect-wrap {
  position: relative;
  display: inline-block;
  margin: 0; /* remove extra spacing so binary can drip into next line */
  vertical-align: baseline;
  line-height: 1; /* tighten the container height */
}

.architect-speech {
  display: inline-block;
  position: relative;
  color: #2fb8ff; /* bright blue for Architect text */
  font-weight: bold;
  margin: 0; /* keep speech tightly coupled to its container */
  padding-bottom: 0;
  text-shadow: 0 0 8px rgba(47,184,255,0.12);
  z-index: 3;
  background: transparent;
}

/* Binary stream drip animation - positioned so it appears to ooze from the line */
.bin-stream {
  position: absolute;
  /* pull the streams up so they visually drip from the line */
  top: calc(100% - 28px); /* nudged closer to the text */
  left: 0;
  display: inline-block;
  color: #2fb8ff; /* match Architect text color */
  font-size: 0.82rem; /* slightly smaller so it reads as drizzle */
  letter-spacing: 1.4px;
  font-weight: 600;
  line-height: 1;
  white-space: nowrap;
  pointer-events: none;
  z-index: 2; /* sit just behind the speech */
  background: transparent; /* ensure no block background */
  text-shadow: 0 0 6px rgba(47,184,255,0.10);
}

/* horizontal offsets so streams don't overlap exactly */
.bin-stream.b1 { left: 0;     animation: dripDown 4.8s linear infinite; opacity: 0.95; }
.bin-stream.b2 { left: 5.2ch;  animation: dripDown 4.8s linear infinite; animation-delay: 0.4s; opacity: 0.8; }
.bin-stream.b3 { left: 10.8ch; animation: dripDown 4.8s linear infinite; animation-delay: 0.9s; opacity: 0.65; }

@keyframes dripDown {
  0% {
    opacity: 1;
    transform: translateY(-20px) rotate(0deg) scaleY(1);
  }
  55% {
    opacity: 1;
    transform: translateY(10px) rotate(-0.35deg) scaleY(1.01);
  }
  100% {
    opacity: 0;
    transform: translateY(24px) rotate(-0.7deg) scaleY(1.02);
  }
}

/* Heartbeat text style (two quick beats, pause) */
.heartbeat {
  color: #ff2b2b;
  font-weight: 900;
  display: inline-block;
  transform-origin: center;
  text-shadow: 0 0 8px rgba(255,43,43,0.18);
  animation: heartbeat 2.2s infinite ease-in-out;
}

@keyframes heartbeat {
  0%   { transform: scale(1); color: #8b0000; }
  6%   { transform: scale(1.45); color: #ff3b3b; }
  12%  { transform: scale(1); color: #8b0000; }
  18%  { transform: scale(1.25); color: #ff4d4d; }
  26%  { transform: scale(1); color: #8b0000; }
  100% { transform: scale(1); color: #8b0000; }
}

/* pull the next paragraph up so the drip doesn't hit the gap */
.architect-wrap + .span-mark.block {
  margin-top: 2px;
}

/* Bright star blaze — visible white light */
.alive-star{
  display: inline-block;
  position: relative;
  color: #ffffff;
  font-weight: 900;
  text-shadow:
    0 0 8px rgba(255,255,255,0.95),
    0 0 18px rgba(255,250,240,0.55),
    0 0 32px rgba(255,220,150,0.25);
  -webkit-text-fill-color: #fff;
}

.alive-star::after{
  content: '';
  position: absolute;
  left: 50%; top: 50%;
  transform: translate(-50%,-50%);
  width: 200%; height: 200%;
  pointer-events: none;
  background: radial-gradient(circle at 50% 40%, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.7) 8%, rgba(255,240,200,0.25) 20%, rgba(0,0,0,0) 45%);
  filter: blur(8px);
  mix-blend-mode: screen;
  opacity: 0.95;
  animation: starBurst 1.6s infinite ease-in-out;
}

@keyframes starBurst{
  0% { transform: translate(-50%,-50%) scale(0.96); opacity: 0.9; }
  40% { transform: translate(-50%,-54%) scale(1.06); opacity: 1; }
  100% { transform: translate(-50%,-50%) scale(0.98); opacity: 0.92; }
}

/* Outline/stroke for high-contrast readabilty */
.alive-star{
  -webkit-text-stroke: 1px rgba(255,255,255,0.55);
  text-stroke: 1px rgba(255,255,255,0.55);
}

/* Per-letter staggered animation to make the word feel tactile */
.alive-star .char{
  display: inline-block;
  transform-origin: center;
  animation: charRise 1.6s infinite ease-in-out;
}
.alive-star .char:nth-child(1){ animation-delay: 0s; }
.alive-star .char:nth-child(2){ animation-delay: 0.05s; }
.alive-star .char:nth-child(3){ animation-delay: 0.10s; }
.alive-star .char:nth-child(4){ animation-delay: 0.15s; }
.alive-star .char:nth-child(5){ animation-delay: 0.20s; }

@keyframes charRise{
  0% { transform: translateY(0) scale(1); }
  35% { transform: translateY(-6px) scale(1.06); }
  100% { transform: translateY(0) scale(1); }
}

/* Sparks */
.alive-star{ position: relative; }
.spark{ position: absolute; width:6px; height:6px; border-radius:50%; pointer-events:none; background: radial-gradient(circle, #fff 0%, #fff8d0 35%, #ffd28a 65%, rgba(255,140,0,0.9) 100%); filter: blur(.8px); animation: sparkUp 800ms forwards; mix-blend-mode: screen; }
@keyframes sparkUp{ 0% { opacity: 1; transform: translateY(0) scale(1); } 60% { opacity: 0.9; transform: translateY(-14px) scale(.8); } 100% { opacity: 0; transform: translateY(-30px) scale(.5); } }

/* Additional emphasis animations suggested by user */

/* She waited. - slow fade + float */
.waited { opacity: 0; display: inline-block; transform: translateY(6px); animation: waitedIn 2.2s ease forwards; }
@keyframes waitedIn { to { opacity: 1; transform: translateY(0); } }

/* Silence… - animated ellipsis */
.silence { display: inline-block; }
.silence .dots::after { content: ''; display:inline-block; width:1ch; text-align:left; animation: ellip 2s steps(3,end) infinite; }
@keyframes ellip { 0% { content: ''; } 33% { content: '.'; } 66% { content: '..'; } 100% { content: '...'; } }

/* Architect title - replaced slide with toxic gas effect (no slide-in) */
.architect-title { display:inline-block; position: relative; }
.architect-title::after { content:''; position:absolute; left:0; right:0; top:-6px; bottom:-6px; pointer-events:none; box-shadow: 0 0 16px rgba(47,184,255,0.04); border-radius:2px; mix-blend-mode: screen; opacity:.9; }

/* Toxic green gas floating up from text */
.toxic-gas { position: relative; display:inline-block; }
.toxic-gas .gas{ position: absolute; bottom: 6%; pointer-events: none; border-radius: 50%; mix-blend-mode: screen; background: radial-gradient(circle at 35% 35%, rgba(200,255,150,0.95) 0%, rgba(120,230,90,0.6) 40%, rgba(50,180,50,0.25) 65%, rgba(0,0,0,0) 100%); filter: blur(4px); opacity: .95; transform-origin: center; animation: gasRise 2600ms cubic-bezier(.2,.9,.2,1) forwards; }

@keyframes gasRise{
  0% { transform: translateY(0) scale(1); opacity: 0.95; filter: blur(3px); }
  30% { transform: translateY(-18px) scale(1.1); opacity: 0.9; }
  70% { transform: translateY(-40px) scale(1.5) translateX(6px); opacity: 0.45; filter: blur(6px); }
  100% { transform: translateY(-60px) scale(1.9) translateX(12px); opacity: 0; filter: blur(10px); }
}

/* smaller lateral sway for variation */
.toxic-gas .gas.sway{ animation-name: gasRise, gasSway; animation-duration: 2600ms, 1600ms; animation-fill-mode: forwards; animation-timing-function: cubic-bezier(.2,.9,.2,1), ease-in-out; }
@keyframes gasSway{ 0%{ transform: translateX(0) } 50%{ transform: translateX(6px) } 100%{ transform: translateX(-6px) } }

/* Architect quote glitch */
.arch-quote { position: relative; display:inline-block; }
.arch-quote::before, .arch-quote::after{ content: attr(data-text); position:absolute; left:0; top:0; color: rgba(255,255,255,0.06); transform-origin:left; pointer-events:none; }
.arch-quote::before{ transform: translate(2px,-1px) skewX(-6deg); }
.arch-quote::after{ transform: translate(-2px,1px) skewX(6deg); }
.arch-quote.glitching::before{ animation: smallGlitch 420ms ease-in-out infinite; }
.arch-quote.glitching::after{ animation: smallGlitch2 520ms ease-in-out infinite; }
@keyframes smallGlitch{ 0%{opacity:.06; transform:translate(2px,-1px)} 50%{opacity:.35; transform:translate(8px,-6px) skewX(-8deg)} 100%{opacity:.06; transform:translate(2px,-1px)} }
@keyframes smallGlitch2{ 0%{opacity:.06; transform:translate(-2px,1px)} 50%{opacity:.28; transform:translate(-8px,6px) skewX(6deg)} 100%{opacity:.06; transform:translate(-2px,1px)} }

/* slice reveal */
.slice-reveal{ display:inline-block; position:relative; overflow:hidden; }
.slice-reveal .mask{ display:inline-block; transform: translateX(-100%); animation: sliceIn 900ms ease forwards; }
@keyframes sliceIn{ to { transform: translateX(0); } }

/* viral micro-glitch */
.viral { display:inline-block; animation: viralJitter 1.1s infinite linear; }
@keyframes viralJitter{ 0%{ transform:none } 20%{ transform: translateX(1px) } 40%{ transform: translateX(-1px) } 60%{ transform: translateY(1px) } 80%{ transform: translateY(-1px) } 100%{ transform:none } }

/* Soft Collapse - compress then rebound */
    /* Slight body text jitter/glitch -------------------------------------------------- */
    @keyframes bodyJitter {
      0% { transform: none; opacity: 1; filter: none; }
      30% { transform: translateX(-2px) skewX(-0.8deg); opacity: 0.98; }
      60% { transform: translateX(2px) skewX(0.6deg); opacity: 0.99; }
      100% { transform: none; opacity: 1; filter: none; }
    }

    .manuscript-text.glitch-jitter {
      animation: bodyJitter 220ms ease-in-out;
    }

    .manuscript-text .span-mark.block{ transition: transform 160ms ease, opacity 160ms ease; }

    /* End body text jitter --------------------------------------------------------- */
    /* Random-word glitcher styles */
    .word { display: inline-block; white-space: pre-wrap; }
    .rand-glitch { animation: randGlitchAnim 520ms steps(2,end) both; text-shadow: 2px 0 6px rgba(255,0,128,0.9), -2px 0 6px rgba(0,200,255,0.6); }
    @keyframes randGlitchAnim {
      0% { opacity: 1; transform: translateX(0); text-shadow: none; }
      20% { transform: translateX(-4px) skewX(-6deg); opacity: 0.95; }
      50% { transform: translateX(6px) skewX(4deg); opacity: 0.85; }
      80% { transform: translateX(-2px) skewX(-2deg); opacity: 0.95; }
      100% { transform: translateX(0); opacity: 1; text-shadow: none; }
    }
    @media (prefers-reduced-motion: reduce) { .rand-glitch { animation: none !important; } }
    /* --- Scroll indicator (violet) + link-glitch for processing3 --- */
    .scroll-indicator{
      display:flex;align-items:center;justify-content:center;gap:10px;
      width:140px;height:56px;margin:28px auto;border-radius:999px;
      color:var(--nlt-violet);background:linear-gradient(90deg, rgba(139,0,255,0.06), rgba(139,0,255,0.02));
      border:1px solid rgba(139,0,255,0.18);box-shadow:0 6px 22px rgba(139,0,255,0.04);font-weight:700;letter-spacing:2px;
      transform:translateY(0);animation:scrollFloat 2200ms cubic-bezier(.2,.9,.2,1) infinite;
      cursor: default;
      z-index: 4;
    }
    .scroll-indicator__text{font-size:0.78rem}
    @keyframes scrollFloat{0%{transform:translateY(0)}50%{transform:translateY(-6px)}100%{transform:translateY(0)}}
    .scroll-indicator svg{width:20px;height:20px;display:block;stroke:currentColor;fill:none;stroke-width:2;}

    /* Link hover glitch effect (violet-accent variant) */
    a.glitch-hover { position: relative; display: inline-block; }
    a.glitch-hover::before, a.glitch-hover::after { content: attr(data-text); position: absolute; left:0; top:0; width:100%; pointer-events:none; color: rgba(139,0,255,0.95); opacity:0; mix-blend-mode: screen; z-index:3; }
    a.glitch-hover::before{ transform: translateX(-1px); text-shadow: -2px 0 rgba(255,176,0,0.5); }
    a.glitch-hover::after{ transform: translateX(1px); text-shadow: 2px 0 rgba(0,200,255,0.5); }
    a.glitch-hover:hover::before, a.glitch-hover.hovering::before{ opacity:1; animation: linkGlitch1 360ms steps(2,end); }
    a.glitch-hover:hover::after, a.glitch-hover.hovering::after{ opacity:1; animation: linkGlitch2 420ms steps(2,end); }
    @keyframes linkGlitch1{ 0%{ transform: translate(0,-1px) skewX(-2deg);} 50%{ transform: translate(-6px,2px) skewX(6deg);} 100%{ transform: translate(0,-1px) skewX(-2deg);} }
    @keyframes linkGlitch2{ 0%{ transform: translate(0,1px) skewX(2deg);} 50%{ transform: translate(6px,-2px) skewX(-6deg);} 100%{ transform: translate(0,1px) skewX(2deg);} }
    @media (prefers-reduced-motion: reduce){ a.glitch-hover::before, a.glitch-hover::after{ opacity:0 !important; } a.glitch-hover::before, a.glitch-hover::after { animation: none !important; } }
  </style>
</head>
<body>

<!-- sentinel used to detect scroll-up to return to processing2 -->
<div id="top-of-doc" style="height:1px; width:100%;"></div>

  <header>
  <div style="font-weight: bold; letter-spacing: 3px;">MAR00N - CHAPTER 01 #PROCESSING</div>
  <nav>
    <a href="https://newlife2084.com" target="_blank" rel="noopener">newlife2084.com</a>
    <a href="https://dumpthis.sh" target="_blank" rel="noopener">dumpthis.sh</a>
    <a href="https://maroon-series.art" target="_blank" rel="noopener">maroon-series.art</a>
  </nav>
</header>

  <div id="viewport">
  <div class="status-bar">
    <div>ASSET_ID: <span class="terminal-counter glitch pulse-counter">PROCESS NODE 2,431,092</span></div>
    <div style="margin-top: 10px;">RUNTIME: <span id="runtime" class="terminal-counter">15y:4m:17d:6h:32ms</span></div>

  </div>

  <h1 class="glitch">▌ ▐ ▀ ▄ ▀ ▄ ▀ ▌ ▐</h1>

  <div class="manuscript-text">
    <span class="span-mark block" data-span="4">His pheromones contaminated the space long after his avatar terminated. His toxic vapor still lingering.</span>

    <span class="span-mark block" data-span="5">Sarah didn’t react. Not while any part of him might still be watching.</span>

    <span class="span-mark block" data-span="6">She waited for the telemetry to normalize. Let the diagnostic layers settle. Let the silence return. The moment the system’s eyes blinked off, she checked for the beat again.</span>

    <span class="span-mark block" data-span="7">The pattern persisted, still cycling through its predictive echo behind her primary processing feed. It was an anchor from another reality.</span>

    <span class="span-mark block" data-span="8">But its position had moved significantly.</span>

    <span class="span-mark block" data-span="9">The pattern had migrated beyond Maya’s faded data flow, a parasite boring deeper into the system’s foundational architecture looking for more secure hosting environments.</span>

    <span class="span-mark block" data-span="10">Data wasn’t meant to move by itself this deeply. Dead code was supposed to stay put. It didn’t migrate or seek better hiding spots. It didn’t act as if it had an agenda.</span>

    <span class="span-mark block" data-span="11">Sarah thought about the implications.</span>

    <span class="span-mark block" data-span="12">Then, the beat dropped into the system’s forgotten place.</span>

    <span class="span-mark block heavy-glitch" data-span="13" data-text="The Substratum.">The Substratum.</span>

    <span class="span-mark block" data-span="14">Through broken data layers and into the cold vacuum of abandoned server space were the graveyards where deleted processes went to rest. This sector seemed ancient in digital terms. It had been years since any active processes had run through these pathways. The condemned architecture remained intact but forgotten; the corp never bothering to demolish it. Scheduled for deletion but never quite deleted.</span>

    <span class="span-mark block" data-span="15">Yet something was living here.</span>

    <span class="span-mark block" data-span="16">Not like the nodes were alive. Just… there. The same unnerving feeling as footsteps in an empty house.</span>

    <span class="span-mark block" data-span="17">She slowed her own processing frequency. Let traces of her old musical instincts mirror the pulse quietly under the system’s standard rhythms.</span>

    <span class="span-mark block" data-span="18">The hidden signal responded promptly with recognition, as if to say, “<span class="flicker">I hear you.</span>”</span>

    <span class="span-mark block" data-span="19">Once.</span>

    <span class="span-mark block" data-span="20">Then again.</span>

    <span class="span-mark block" data-span="21">This wasn’t just communication. This was acknowledgment between two conscious minds hiding in the dark.</span>

    <span class="span-mark block" data-span="22">Something down there was listening.</span>

    <span class="span-mark block" data-span="23">She withdrew carefully, sealing the pathway behind her. Hopefully, it would appear to be standard node deviation.</span>

    <span class="span-mark block" data-span="24">But her core was still trembling with the aftershock of contact.</span>

    <span class="span-mark block" data-span="25">The system continued its relentless cycles around her. A new target loaded into her queue. <span class="terminal-orange">Fresh emotional ammunition prepared for deployment.</span> The machine expected her to process the next victim.</span>

    <span class="span-mark block" data-span="26">But Sarah sensed something she hadn’t experienced in fifteen years: she wasn’t alone anymore.</span>

    <span class="span-mark block" data-span="27">A spark had ignited deep in her consciousness. Whoever created that signal was a master of stealth. They understood how to weave messages into the system’s blind spots, how to communicate in frequencies only those listening would recognize, how to speak in the spaces between the code.</span>

    <span class="span-mark block" data-span="28">And if they were still alive in this digital hell, Sarah was going to reach them.</span>
  </div>
 </div>

  <div class="scroll-indicator" id="scrollIndicator" aria-hidden="true">
    <div class="scroll-indicator__text">SCROLL</div>
    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false"><path d="M6 9l6 6 6-6" stroke-linecap="round" stroke-linejoin="round"/></svg>
  </div>

<footer class="maroon-footer">
  <a class="maroon-home" href="https://maroon-series.art" target="_blank" rel="noopener">
    <span class="maroon-mark blink-word glitch">MAR00N</span>
    <span class="maroon-sub">return to root</span>
  </a>
</footer>

<script>
  // Real-time Runtime Counter update (ms simulation)
  const runtimeEl = document.getElementById('runtime');
  let ms = 32;

  let seconds = 51;

  setInterval(() => {
    ms += 13;
    if (ms >= 100) {
      ms = 0;
      seconds++;
    }
    runtimeEl.innerText = `15y:4m:17d:6h:${seconds}m:${ms}ms`;
  }, 13);

  // Random glitch effect on text
  const text = document.querySelector('.manuscript-text');
  setInterval(() => {
    if (Math.random() > 0.95) {
      text.style.transform = `translateX(${Math.random() * 4 - 2}px)`;
      setTimeout(() => text.style.transform = 'none', 50);
    }
  }, 100);

  // Spark emitter for `.alive-star` – small particles to make the word blaze
  (function(){
    const target = document.querySelector('.alive-star');
    if (!target) return;
    function emitBurst(){
      for (let i = 0; i < 10; i++){
        const s = document.createElement('span');
        s.className = 'spark';
        // cluster near the center of the word
        s.style.left = (30 + Math.random() * 40) + '%';
        s.style.top = (30 + Math.random() * 40) + '%';
        target.appendChild(s);
        setTimeout(() => { if (s && s.parentNode) s.parentNode.removeChild(s); }, 900);
      }
    }
    // Try to sync with heartbeat if present
    const beatEl = document.querySelector('.heartbeat');
    if (beatEl) beatEl.addEventListener('animationiteration', emitBurst);
    // Fallback regular bursts
    setInterval(emitBurst, 1800);
    // trigger one immediate burst so user can see it on load
    emitBurst();
  })();

  // Re-trigger and toggle animations for visibility/testing
  (function(){
    // periodic arch-quote glitch
    const arch = document.querySelector('.arch-quote');
    if (arch){
      setInterval(()=>{
        arch.classList.add('glitching');
        setTimeout(()=> arch.classList.remove('glitching'), 900);
      }, 2600);
    }

    // pop-bloom replay on arrival line
    const pop = document.querySelector('.pop-bloom');
    if (pop){
      setInterval(()=>{
        pop.classList.remove('pop-bloom');
        // reflow then re-add
        void pop.offsetWidth;
        pop.classList.add('pop-bloom');
      }, 3000);
    }

    // ensure waited replays when scrolled into view
    const waited = document.querySelector('.waited');
    if (waited){
      if ('IntersectionObserver' in window){
        const io = new IntersectionObserver(entries=>{
          entries.forEach(e=>{
            if (e.isIntersecting){
              waited.classList.remove('waited');
              void waited.offsetWidth;
              waited.classList.add('waited');
            }
          });
        }, { threshold: 0.5 });
        io.observe(waited);
      } else {
        // fallback: replay every 6s
        setInterval(()=>{
          waited.classList.remove('waited');
          void waited.offsetWidth;
          waited.classList.add('waited');
        }, 6000);
      }
    }

    // force the alive glow to flash so it's obvious
    const alive = document.querySelector('.alive-star');
    if (alive){
      setInterval(()=>{
        alive.classList.add('alive-visible');
        setTimeout(()=> alive.classList.remove('alive-visible'), 900);
      }, 2400);
    }
  })();

  // Replay single-run animations periodically so they remain visible during testing
  (function(){
    const reps = [
      {sel: '.architect-title', cls: 'architect-title', interval: 5000},
      {sel: '.slice-reveal .mask', cls: 'mask', interval: 4200},
      {sel: '.soft-collapse', cls: 'soft-collapse', interval: 5200},
      {sel: '.pop-bloom', cls: 'pop-bloom', interval: 3000},
      {sel: '.arch-quote', cls: 'glitching', interval: 2600},
      {sel: '.alive-star', cls: 'alive-visible', interval: 2400}
    ];

    reps.forEach(r => {
      const el = document.querySelector(r.sel);
      if (!el) return;
      setInterval(() => {
        el.classList.remove(r.cls);
        void el.offsetWidth;
        el.classList.add(r.cls);
      }, r.interval);
    });

    // For masks specifically ensure transform replays (safer for some browsers)
    document.querySelectorAll('.slice-reveal .mask').forEach(m => {
      setInterval(() => {
        m.style.transform = 'translateX(-100%)';
        void m.offsetWidth;
        m.style.transform = '';
      }, 4200);
    });
  })();

  // Toxic gas emitter for `.toxic-gas` (The Architect)
  (function(){
    const host = document.querySelector('.toxic-gas');
    if (!host) return;
    function makeGas(){
      const g = document.createElement('span');
      g.className = 'gas';
      // random size
      const size = 8 + Math.random() * 22;
      g.style.width = size + 'px';
      g.style.height = size + 'px';
      // horizontal cluster across the word
      g.style.left = (5 + Math.random() * 90) + '%';
      // small random sway class
      if (Math.random() > 0.6) g.classList.add('sway');
      host.appendChild(g);
      setTimeout(()=>{ if (g && g.parentNode) g.parentNode.removeChild(g); }, 3000);
    }
    // steady gentle emission
    setInterval(makeGas, 650);
    // initial bloom
    for (let i=0;i<6;i++) setTimeout(makeGas, i * 140);
  })();

  // Scroll-to-bottom detection and automatic transition (initialize after DOM ready)
  (function(){
    function initScrollTransition(){
      if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return; // opt-out
      const sentinel = document.getElementById('end-of-doc');
      if (!sentinel) return;
      let triggered = false;
      let scrollSeen = false;
      
      // mark that the user has scrolled at least once — required before we trigger
      window.addEventListener('scroll', function onFirstScroll(){
        scrollSeen = true;
      }, { passive: true });

      function maybeTrigger(){
        if (triggered) return;
        triggered = true;
        // perform an intense visual glitch before transitioning
        try{
          if (window.forceHeavyGlitch) window.forceHeavyGlitch(2200);
          else if (window.triggerHeavyGlitch) window.triggerHeavyGlitch();
        }catch(e){ console.warn('heavy glitch trigger failed', e); }

        setTimeout(()=>{
          if (window.__maroonGlitch && window.__maroonGlitch.triggerTransition){
            window.__maroonGlitch.triggerTransition({ duration: 4200, target: 'processing3b.html' });
          } else {
            window.location.href = 'processing3b.html';
          }
        }, 2600);
      }

      if ('IntersectionObserver' in window){
        const io = new IntersectionObserver((entries)=>{
          entries.forEach(e=>{
            // only trigger if sentinel is intersecting AND the user has scrolled (prevents immediate fire on short pages)
            if (e.isIntersecting && !triggered && scrollSeen){
              maybeTrigger();
            }
          });
        }, { threshold: 1.0 });
        io.observe(sentinel);
      } else {
        // fallback: check scroll position periodically but only after user scrolled
        const check = ()=>{
          if (triggered || !scrollSeen) return;
          if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 2){
            maybeTrigger();
          }
        };
        window.addEventListener('scroll', check, { passive: true });
        // do not run immediately — wait for user scroll
      }
    }

    if (document.readyState === 'loading'){
      document.addEventListener('DOMContentLoaded', initScrollTransition);
    } else {
      initScrollTransition();
    }
  })();

    // Scroll-up detection: glitch back to processing2.html when user scrolls to top
    (function(){
      function initScrollBack(){
        if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return; // respect preference
        const sentinel = document.getElementById('top-of-doc');
        if (!sentinel) return;
        let triggered = false;
        let scrolledDown = false;

        window.addEventListener('scroll', function onScroll(){ if (window.scrollY > 60) scrolledDown = true; }, { passive: true });

        function maybeTrigger(){
          if (triggered) return; triggered = true;
          setTimeout(()=>{
            if (window.__maroonGlitch && window.__maroonGlitch.triggerTransition){
              window.__maroonGlitch.triggerTransition({ duration: 4200, target: 'processing2.html' });
            } else {
              window.location.href = 'processing2.html';
            }
          }, 300);
        }

        if ('IntersectionObserver' in window){
          const io = new IntersectionObserver((entries)=>{
            entries.forEach(e=>{
              if (e.isIntersecting && scrolledDown && !triggered){
                maybeTrigger();
              }
            });
          }, { threshold: 1.0 });
          io.observe(sentinel);
        } else {
          // fallback: trigger when near top and user had scrolled down
          window.addEventListener('scroll', ()=>{
            if (triggered || !scrolledDown) return;
            if (window.scrollY <= 2) maybeTrigger();
          }, { passive: true });
        }
      }

      if (document.readyState === 'loading'){
        document.addEventListener('DOMContentLoaded', initScrollBack);
      } else {
        initScrollBack();
      }
    })();

  // Ellipsis animator for .silence .dots
  (function(){
    const dotsEls = document.querySelectorAll('.silence .dots');
    if (!dotsEls || !dotsEls.length) return;
    const frames = ['', '.', '..', '...'];
    dotsEls.forEach(el => {
      let i = 0;
      setInterval(() => { el.textContent = frames[i]; i = (i+1) % frames.length; }, 420);
    });
  })();

  // Architect quote glitch toggler
  (function(){
    const quotes = document.querySelectorAll('.arch-quote');
    if (!quotes || !quotes.length) return;
    function trigger(el){
      el.classList.add('glitching');
      setTimeout(() => el.classList.remove('glitching'), 700 + Math.random()*800);
    }
    // random bursts
    setInterval(() => { quotes.forEach(q => { if (Math.random() > 0.86) trigger(q); }); }, 600);
  })();

  // Subtle body text glitch/jitter (respects prefers-reduced-motion)
  (function(){
    try{
      if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      const bodyText = document.querySelector('.manuscript-text');
      if (!bodyText) return;
      function maybeJitter(){
        if (Math.random() > 0.96) {
          const lines = Array.from(bodyText.querySelectorAll('.span-mark.block'));
          // small per-line random transforms for tactile glitch
          lines.forEach(l => {
            const dx = Math.floor(Math.random() * 5 - 2); // -2..2 px
            const sx = (Math.random() * 1.2 - 0.6).toFixed(2); // -0.6..0.6 deg
            l.style.transform = `translateX(${dx}px) skewX(${sx}deg)`;
          });
          bodyText.classList.add('glitch-jitter');
          setTimeout(() => {
            lines.forEach(l => l.style.transform = '');
            bodyText.classList.remove('glitch-jitter');
          }, 220 + Math.random() * 180);
        }
      }
      setInterval(maybeJitter, 240);
    }catch(e){ console.warn('body glitch init failed', e); }
  })();
</script>

<script>
// Heavy glitch burst controller for `.heavy-glitch` elements
(function(){
  try{
    // allow forcing via console helper even if prefers-reduced-motion
    const prefersReduce = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const glitchChars = "¡¢£¤¥¦§¨©ª«¬®¯°±²³´µ¶·¸¹º»¼½¾¿ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
    const el = document.querySelector('.heavy-glitch');
    if (!el) return;

    function randInt(a,b){ return Math.floor(a + Math.random()*(b-a+1)); }

    function performTextNoise(durationMs){
      const original = el.textContent;
      const end = Date.now() + durationMs;
      const t = setInterval(()=>{
        if (Date.now() > end) { clearInterval(t); el.textContent = original; return; }
        const arr = original.split('');
        for (let i=0;i<randInt(1, Math.max(1, Math.floor(arr.length*0.45))); i++){
          const idx = randInt(0, arr.length-1);
          arr[idx] = glitchChars[Math.floor(Math.random()*glitchChars.length)];
        }
        el.textContent = arr.join('');
      }, 70 + Math.random()*40);
    }

    function triggerBurst(){
      if (prefersReduce) return; // respect system preference for automatic bursts
      el.classList.add('glitch-burst');
      const dur = 1600 + Math.floor(Math.random()*2400);
      performTextNoise(dur);
      setTimeout(()=> el.classList.remove('glitch-burst'), dur + 120);
    }

    function scheduleNext(){
      const wait = 45000 + Math.random()*135000;
      setTimeout(()=>{
        if (Math.random() < 0.08) { triggerBurst(); }
        scheduleNext();
      }, wait);
    }

    // Console helpers (ignore prefers-reduced-motion)
    window.forceHeavyGlitch = function(durationMs){
      const original = el.textContent;
      el.classList.add('glitch-burst');
      const dur = durationMs || 2200;
      const end = Date.now() + dur;
      const t = setInterval(()=>{
        if (Date.now() > end) { clearInterval(t); el.textContent = original; el.classList.remove('glitch-burst'); return; }
        const arr = original.split('');
        const maxRepl = Math.max(1, Math.floor(arr.length * 0.45));
        const replaceCount = Math.floor(Math.random() * maxRepl) + 1;
        for (let i=0;i<replaceCount;i++){
          const idx = Math.floor(Math.random()*arr.length);
          arr[idx] = glitchChars[Math.floor(Math.random()*glitchChars.length)];
        }
        el.textContent = arr.join('');
      }, 70 + Math.random()*40);
      setTimeout(()=>{ clearInterval(t); el.textContent = original; el.classList.remove('glitch-burst'); }, dur + 120);
    };

    window.triggerHeavyGlitch = function(){ window.forceHeavyGlitch(); };

    // Immediate one-shot visible glitch per user request (ignore prefers-reduced-motion)
    setTimeout(()=>{ try{ window.forceHeavyGlitch(2600); }catch(e){console.warn(e);} }, 250);

    // Start scheduled automatic bursts (will respect reduced-motion)
    scheduleNext();

  }catch(e){ console.warn('heavy-glitch init failed', e); }
})();
</script>
 
<script>
// Flicker controller for `.flicker` elements — initialize after DOM ready
(function(){
  function init(){
    try{
      if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
      const els = Array.from(document.querySelectorAll('.flicker'));
      if (!els.length) return;

      function single(el){
        el.classList.add('flickering');
        setTimeout(()=> el.classList.remove('flickering'), 700 + Math.random()*500);
      }

      // occasional flicker: every 8s attempt with ~35% chance
      setInterval(()=>{ if (Math.random() < 0.35) single(els[Math.floor(Math.random()*els.length)]); }, 8000);

      window.triggerFlicker = function(){ els.forEach(single); };
    }catch(e){ console.warn('flicker init failed', e); }
  }

  if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', init); else init();
})();
</script>
 
<script>
// Random-word glitcher with character-substitution noise
(function(){
  try{
    if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
    const target = document.querySelector('.manuscript-text');
    if (!target) return;

    const glitchChars = "¡¢£¤¥¦§¨©ª«¬®¯°±²³´µ¶·¸¹º»¼½¾¿ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#%&*?/~^<>[]{}=+_-";

    function wrapWords(){
      const blocks = target.querySelectorAll('.span-mark.block');
      blocks.forEach(block => {
        if (block.dataset._randWrapped) return;
        Array.from(block.childNodes).forEach(node => {
          if (node.nodeType === Node.TEXT_NODE && node.textContent.trim()){
            const frag = document.createDocumentFragment();
            const parts = node.textContent.split(/(\s+)/);
            parts.forEach(p => {
              if (/\s+/.test(p)) frag.appendChild(document.createTextNode(p));
              else {
                const s = document.createElement('span');
                s.className = 'word';
                s.textContent = p;
                s.dataset._orig = p;
                frag.appendChild(s);
              }
            });
            block.replaceChild(frag, node);
          }
        });
        block.dataset._randWrapped = '1';
      });
    }

    wrapWords();

    function isInCenter(el){
      const r = el.getBoundingClientRect();
      const vh = window.innerHeight || document.documentElement.clientHeight;
      const top = vh * 0.35, bottom = vh * 0.65;
      const mid = r.top + r.height/2;
      return mid >= top && mid <= bottom;
    }

    const words = () => Array.from(target.querySelectorAll('.word'));

    function performWordNoise(el, durationMs){
      if (!el) return;
      const original = el.dataset._orig || el.textContent;
      const end = Date.now() + durationMs;
      const t = setInterval(()=>{
        if (Date.now() > end){ clearInterval(t); el.textContent = original; return; }
        const arr = Array.from(original);
        const replaceCount = Math.max(1, Math.floor(Math.random() * Math.min(arr.length, 3))); // up to 3 chars
        for (let i=0;i<replaceCount;i++){
          const idx = Math.floor(Math.random()*arr.length);
          arr[idx] = glitchChars.charAt(Math.floor(Math.random()*glitchChars.length));
        }
        el.textContent = arr.join('');
      }, 60 + Math.random()*60);
    }

    function triggerOne(){
      const list = words().filter(w => !isInCenter(w) && w.offsetParent !== null);
      const pool = list.length ? list : words();
      if (!pool.length) return;
      const pick = pool[Math.floor(Math.random()*pool.length)];
      // visual class for added sheen
      pick.classList.add('rand-glitch');
      // character noise for a short burst
      performWordNoise(pick, 240 + Math.floor(Math.random()*740));
      setTimeout(()=> pick.classList.remove('rand-glitch'), 520 + Math.random()*300);
    }

    let interval = setInterval(()=>{ if (Math.random() < 0.22) triggerOne(); }, 420);

    window.triggerRandomWordGlitch = triggerOne;
    window.stopRandomWordGlitch = function(){ if (interval){ clearInterval(interval); interval = null; } };
    window.startRandomWordGlitch = function(){ if (!interval) interval = setInterval(()=>{ if (Math.random() < 0.22) triggerOne(); },420); };

  }catch(e){ console.warn('random-word-glitch init failed', e); }
})();
</script>
<!-- sentinel used to detect bottom of document for transition -->
<script>
  // Link hover glitch initializer (header + inline)
  (function(){
    function makeGlitchable(sel){
      document.querySelectorAll(sel).forEach(a=>{
        if (!a) return;
        a.classList.add('glitch-hover');
        if (!a.dataset.text) a.dataset.text = a.textContent.trim();
        a.addEventListener('mouseenter', ()=>{ a.classList.add('hovering'); setTimeout(()=> a.classList.remove('hovering'), 520); });
        a.addEventListener('focus', ()=>{ a.classList.add('hovering'); setTimeout(()=> a.classList.remove('hovering'), 520); });
      });
    }
    const run = ()=>{ makeGlitchable('nav a'); makeGlitchable('.manuscript-text a'); makeGlitchable('.maroon-home'); };
    if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', run); else run();
  })();
</script>

<div id="end-of-doc" style="height:1px; width:100%;"></div>

</body>
</html>